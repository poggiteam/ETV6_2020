---
title: "Figures"
author: "Timothée Bigot"
date: "29/03/2022"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 2
    code_folding: hide
  pdf_document: 
    toc: true
    toc_depth: 3
    highlight: zenburn
editor_options: 
  chunk_output_type: console
---
---
title:  "Figures à jour le 29/03/2022"
---

This Rmarkdown contains the code to obtain all plots necessary to produce our bioinformatical related figures. Final figure anotation and layout were produced with PhotoShop.


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
OUTPUT_PATH <- "/home/bigott/workspace2/01_tim/01_these/01_etv6/05_Outputs/06_Février_2022/03_2020-42-set1et2/combined/"

ctrl.object <- readRDS(file = "/home/bigott/workspace2/01_tim/01_these/01_etv6/05_Outputs/06_Février_2022/03_2020-42-set1et2/ctrl/ctrl_object.rds")
pat.object <- readRDS(file = "/home/bigott/workspace2/01_tim/01_these/01_etv6/05_Outputs/06_Février_2022/03_2020-42-set1et2/patients/pat_object.rds")
ETV6_2020 <- readRDS(file = "/home/bigott/workspace2/01_tim/01_these/01_etv6/05_Outputs/06_Février_2022/03_2020-42-set1et2/combined/ETV6_2020_regressed_final.rds")

all.genes <- rownames(ETV6_2020)

library(Seurat)
library(ggplot2)
library(dplyr)
library(ggrepel)
```

# Figure 1 {.tabset}
## Panel B
```{r,fig.width=10,fig.height=10}
# Plotting ctrl.object UMAP with "orig.ident"
ctrl.object@meta.data$orig.ident <- factor(ctrl.object@meta.data$orig.ident,
                                           levels = c("D6", "D11")
                                           )
DimPlot(object = ctrl.object,
        pt.size = 0.7,
        reduction = "umap",
        group.by = "orig.ident",
        order = T
        )
```

## Panel C
```{r,fig.width=10,fig.height=10}
# Plotting ctrl.object UMAP with "RNA_snn_res.1.2"
DimPlot(object = ctrl.object,
        pt.size = 0.7,
        reduction = "umap",
        group.by = "RNA_snn_res.1.2",
        order = T,
        label = T,
        label.size = 6
        )
```

## Panel D
```{r,fig.width=16,fig.height=8}
# DotPlot of supervised signatures for clusters identification
Idents(ctrl.object) <- "RNA_snn_res.1.2"
ctrl.object@active.ident <- factor(ctrl.object@active.ident,
                                   levels = c("14","12","8","3","6","1","2","0","4","5","9","11","7","10","13")
                                   )
dp <- DotPlot(ctrl.object,
              features = c("THY1","PROM1","FLT3","CRHBP","HOPX","AVP","KIT","SPINK2","CSF3R","MPO","ELANE","PRTN3","AZU1","SERPINB10","CTSG","CPA3","CLC","PRG2","TPSAB1","VWA5A","CD38","TFRC","DEPTOR","KLF1","TFR2","HBB","APOC1","ANK1","ACSM3","LMNA","CAVIN2","LAT","CD9","STOM","PLEK","ITGA2B","GP9","GP6","GP1BA","PF4","RASGRP2","MPIG6B","VWF","PPBP","SELP","LTBP1")
              ) + 
  geom_point(aes(size=pct.exp),
             shape = 21,
             colour="black",
             stroke=0.5
             ) + 
  scale_colour_gradient2(low = "steelblue",
                         mid = "ivory1",
                         high = "red"
                         ) + 
  guides(size=guide_legend(override.aes=list(shape=21, colour="black", fill="white"))
         ) + 
  RotatedAxis()
dp
```

## Panel E
```{r,fig.width=16,fig.height=8}
# Unsupervised DotPlot with top 5 genes
# FindAllMarkers
if(file.exists(paste(OUTPUT_PATH, "ctrl_FAM.csv", sep = ""))){
  ctrl.markers <- read.csv(file = paste(OUTPUT_PATH, "ctrl_FAM.csv", sep = ""))
  }else{
  Idents(ctrl.object) <- "RNA_snn_res.1.2"
  ctrl.markers <- FindAllMarkers(ctrl.object,
                                        only.pos = F,
                                        min.pct = 0.1,
                                        logfc.threshold = 0.25,
                                        verbose = T
                                        )
  write.csv(ctrl.markers,
                   file = paste(OUTPUT_PATH,
                                "ctrl_FAM.csv",
                                sep = ""
                   )
            )
  }

# Selecting Top 5 genes per cluster and making a list of it
top_genes <- ctrl.markers %>%
  group_by(cluster) %>%
  top_n(5, avg_log2FC)
length(top_genes$gene)

# Ensuring no doublets
str_top_genes <- unique(as.character(top_genes$gene))
length(str_top_genes)

# DotPlot
dp <- DotPlot(ctrl.object,
              features = str_top_genes
              ) +
  geom_point(aes(size=pct.exp),
             shape = 21,
             colour="black",
             stroke=0.5
             ) + 
  scale_colour_gradient2(low = "steelblue",
                         mid = "ivory1",
                         high = "red"
                         ) + 
  guides(size=guide_legend(override.aes=list(shape=21, colour="black", fill="white"))
         ) +
  RotatedAxis()
dp
```

## Panel F {.tabset}
```{r,fig.width=10,fig.height=10}
# FeaturePlots
gene_list <- c("CRHBP","PROM1","PRG2","MPO","CD34","CD38","KIT","HBB","ITGA2B","PLEK","CAVIN2","LAT","LMNA","SELP","PF4")

for (i in 1:length(gene_list)){
    tryCatch({
      print(paste("###", gene_list[i], sep = " "))
      print(FeaturePlot(object = ctrl.object,
                        features = gene_list[i],
                        reduction = "umap",
                        cols = c("grey","lightblue","cyan3","cyan4","dodgerblue3","blue","mediumslateblue","purple","orchid3","red","brown","black"),
                        pt.size = 0.7)+
              NoAxes()+
              NoLegend()
            )
    }, error=function(e){cat("ERROR :",conditionMessage(e), "\n")})
}
```


# Figure 2 {.tabset}
## Panel A
```{r,fig.width=10,fig.height=10}
# ggplot UMAP with mRNA counts
UMAP <- data.frame(UMAP_1 = ctrl.object@reductions$umap@cell.embeddings[,1],
                   UMAP_2 = ctrl.object@reductions$umap@cell.embeddings[,2],
                   gene = ctrl.object@meta.data$nCount_RNA)

Mutation = ctrl.object@meta.data$ETV6status
Max=max(ctrl.object@meta.data$nCount_RNA)
Min=min(ctrl.object@meta.data$nCount_RNA)

ggplot(UMAP,aes(x=UMAP_1,y=UMAP_2)
       )+
  geom_point(aes(
    color=gene,
    shape = Mutation)
    )+
  scale_colour_gradient2(low = "blue",
                         mid="orange",
                         high="red",
                         name="mRNA count",
                         midpoint=(Max+Min)/2
                         )
```

## Panel B
```{r,fig.width=10,fig.height=10}
# ggplot UMAP with genes expressed counts
UMAP <- data.frame(UMAP_1 = ctrl.object@reductions$umap@cell.embeddings[,1],
                   UMAP_2 = ctrl.object@reductions$umap@cell.embeddings[,2],
                   gene = ctrl.object@meta.data$nFeature_RNA)

Mutation = ctrl.object@meta.data$ETV6status
Max=max(ctrl.object@meta.data$nFeature_RNA)
Min=min(ctrl.object@meta.data$nFeature_RNA)

ggplot(UMAP,aes(x=UMAP_1,y=UMAP_2)
       )+
  geom_point(aes(color=gene, shape = Mutation)
             ) + 
  scale_colour_gradient2(low = "blue",
                         mid="orange",
                         high="red",
                         name="n° of genes expressed",
                         midpoint=(Max+Min)/2
                         )
```

## Panel C
```{r,fig.width=10,fig.height=10}
# FeaturePlot on signatures estimated from literature and implemented with genes from top 20 genes of each clusters
# Defining signatures & adding them to the object by incorporating it in the meta.data
ctrl.object <- AddModuleScore(ctrl.object,
                              features = list(c("PROM1","FLT3","CRHBP","HOPX","AVP","IGHM","GLIPR1")),
                              name = "HSPC"
                              )
ctrl.object <- AddModuleScore(ctrl.object,
                              features = list(c("CPA3","PRG2","RHEX","ALOX5AP","MS4A2")),
                              name = "CMP"
                              )
ctrl.object <- AddModuleScore(ctrl.object,
                              features = list(c("MS4A3","RNASE2","EPX","CLC","CSF2RB","CTSG")),
                              name = "non_primed_CMP"
                              )
ctrl.object <- AddModuleScore(ctrl.object,
                              features = list(c("LMNA","CAVIN2","LAT","VWA5A","KIT","HPGDS","KRT1","TPSB2","TPSAB1","TMEM176B","SAMSN1","CD44")),
                              name = "Mk_primed_CMP"
                              )
ctrl.object <- AddModuleScore(ctrl.object,
                              features = list(c("CSTA","MPO","ELANE","PRTN3","AZU1","RNASE3","CFD")),
                              name = "GMP"
                              )
ctrl.object <- AddModuleScore(ctrl.object,
                              features = list(c("CD38","KLF1","DEPTOR","ACSM3","APOC1","TFRC","ANK1","TMSB10","ALDH1A1","MT-ATP8","H2AFY","GYPB")),
                              name = "MEP"
                              )
ctrl.object <- AddModuleScore(ctrl.object,
                              features = list(c("BLVRB","HBB","APOC1","TFR2")),
                              name = "MEP_ERP"
                              )
ctrl.object <- AddModuleScore(ctrl.object,
                              features = list(c("MPIG6B","PF4","GP9","VWF","PPBP","SH3BP5","SELP","LTBP1","TMEM40")),
                              name = "MkP_Mk"
                              )

# FeaturePlots {.tabset}
sig_list <- c("HSPC1","CMP1","non_primed_CMP1","Mk_primed_CMP1","GMP1","MEP1","MEP_ERP1","MkP_Mk1")

for (i in 1:length(sig_list)){
    tryCatch({
      print(paste("###", sig_list[i], sep = " "))
      print(FeaturePlot(object = ctrl.object,
                        features = sig_list[i],
                        reduction = "umap",
                        cols = c("grey","lightblue","cyan3","cyan4","dodgerblue3","blue","mediumslateblue","purple","orchid3","red","brown","black"),
                        pt.size = 0.7)+
              NoAxes()+
              NoLegend()
            )
    }, error=function(e){cat("ERROR :",conditionMessage(e), "\n")})
}
```

## Panel D
```{r,fig.width=10,fig.height=10}
# Cell assignation based on signatures & both DotPlots
Idents(ctrl.object) <- "RNA_snn_res.1.2"
ctrl.object@meta.data$celltypes <- "NA"

for (i in 1:length(rownames(ctrl.object@meta.data))){
    if (ctrl.object@meta.data$RNA_snn_res.1.2[i] %in% c(1,6,3,8,12)){
      ctrl.object@meta.data$celltypes[i] <- "MkP_Mk"
      }
    if (ctrl.object@meta.data$RNA_snn_res.1.2[i] %in% 14){
      ctrl.object@meta.data$celltypes[i] <- "Plt"
      }
    if (ctrl.object@meta.data$RNA_snn_res.1.2[i] %in% c(2,0,4,5,9)){
      ctrl.object@meta.data$celltypes[i] <- "MEP"
      }
    if (ctrl.object@meta.data$RNA_snn_res.1.2[i] %in% 7){
      ctrl.object@meta.data$celltypes[i] <- "CMP"
      }
    if (ctrl.object@meta.data$RNA_snn_res.1.2[i] %in% 11){
      ctrl.object@meta.data$celltypes[i] <- "CMP_Primed"
      }
    if (ctrl.object@meta.data$RNA_snn_res.1.2[i] %in% 13){
      ctrl.object@meta.data$celltypes[i] <- "GMP"
      }
    if (ctrl.object@meta.data$RNA_snn_res.1.2[i] %in% 10){
      ctrl.object@meta.data$celltypes[i] <- "HSPC"
      }
}

# Plotting by celltypes
DimPlot(object = ctrl.object,
        pt.size = 0.7,
        reduction = "umap",
        group.by = "celltypes",
        order = T
        )
```

# Figure 3 {.tabset}
## Panel A
```{r,fig.width=20,fig.height=20}
# Plotting pat.object UMAP with "orig.ident"
pat.object@meta.data$orig.ident <- factor(pat.object@meta.data$orig.ident,
                                           levels = c("D6", "D11")
                                           )
DimPlot(object = pat.object,
        pt.size = 0.7,
        reduction = "umap",
        group.by = "orig.ident",
        order = T
        )
```

## Panel B
```{r,fig.width=10,fig.height=10}
# Plotting pat.object UMAP with "RNA_snn_res.0.8"
DimPlot(object = pat.object,
        pt.size = 0.7,
        reduction = "umap",
        group.by = "RNA_snn_res.0.8",
        order = T,
        label = T,
        label.size = 4
        )
```

## Panel C
```{r,fig.width=16,fig.height=8}
# DotPlot of same supervised signatures for clusters identification
Idents(pat.object) <- "RNA_snn_res.0.8"
pat.object@active.ident <- factor(pat.object@active.ident,
                                  levels = c("1","0","8","6","2","5","4","10","7","3","9")
                                  )                                   
dp <- DotPlot(pat.object,
              features = c("THY1","PROM1","FLT3","CRHBP","HOPX","AVP","KIT","SPINK2","CSF3R","MPO","ELANE","PRTN3","AZU1","SERPINB10","CTSG","CPA3","CLC","PRG2","TPSAB1","VWA5A","CD38","TFRC","DEPTOR","KLF1","TFR2","HBB","APOC1","ANK1","ACSM3","LMNA","CAVIN2","LAT","CD9","STOM","PLEK","ITGA2B","GP9","GP6","GP1BA","PF4","RASGRP2","MPIG6B","VWF","PPBP","SELP","LTBP1")
              ) + 
  geom_point(aes(size=pct.exp),
             shape = 21,
             colour="black",
             stroke=0.5
             ) + 
  scale_colour_gradient2(low = "steelblue",
                         mid = "ivory1",
                         high = "red"
                         ) + 
  guides(size=guide_legend(override.aes=list(shape=21, colour="black", fill="white"))
         ) + 
  RotatedAxis()
dp
```

## Panel D
```{r,fig.width=16,fig.height=8}
# Unsupervised DotPlot with top 5 genes
# FindAllMarkers
if(file.exists(paste(OUTPUT_PATH, "pat_FAM.csv", sep = ""))){
  pat.markers <- read.csv(file = paste(OUTPUT_PATH, "pat_FAM.csv", sep = ""))
  }else{
  Idents(pat.object) <- "RNA_snn_res.1.2"
  pat.markers <- FindAllMarkers(pat.object,
                                        only.pos = F,
                                        min.pct = 0.1,
                                        logfc.threshold = 0.25,
                                        verbose = F
                                        )
  write.csv(pat.markers,
                   file = paste(OUTPUT_PATH,
                                "pat_FAM.csv",
                                sep = ""
                   )
            )
  }

# Selecting Top 5 genes per cluster and making a list of it
top_genes <- pat.markers %>%
  group_by(cluster) %>%
  top_n(5, avg_log2FC)
length(top_genes)

# Ensuring no doublets
str_top_genes <- unique(as.character(top_genes$gene))
length(str_top_genes)

# DotPlot
dp <- DotPlot(pat.object,
              features = str_top_genes
              ) +
  geom_point(aes(size=pct.exp),
             shape = 21,
             colour="black",
             stroke=0.5
             ) + 
  scale_colour_gradient2(low = "steelblue",
                         mid = "ivory1",
                         high = "red"
                         ) + 
  guides(size=guide_legend(override.aes=list(shape=21, colour="black", fill="white"))
         ) +
  RotatedAxis()
dp
```

## Panel E {.tabset}
```{r,fig.width=10,fig.height=10}
# FeaturePlot on signatures estimated from literature and implemented with genes from top 20 genes of each clusters
# Defining signatures & adding them to the object by incorporating it in the meta.data
pat.object <- AddModuleScore(pat.object,
                              features = list(c("PROM1","FLT3","CRHBP","HOPX","AVP","IGHM","GLIPR1")),
                              name = "HSPC"
                              )
pat.object <- AddModuleScore(pat.object,
                              features = list(c("CPA3","PRG2","RHEX","ALOX5AP","MS4A2")),
                              name = "CMP"
                              )
pat.object <- AddModuleScore(pat.object,
                              features = list(c("MS4A3","RNASE2","EPX","CLC","CSF2RB","CTSG")),
                              name = "non_primed_CMP"
                              )
pat.object <- AddModuleScore(pat.object,
                              features = list(c("LMNA","CAVIN2","LAT","VWA5A","KIT","HPGDS","KRT1","TPSB2","TPSAB1","TMEM176B","SAMSN1","CD44")),
                              name = "Mk_primed_CMP"
                              )
pat.object <- AddModuleScore(pat.object,
                              features = list(c("CSTA","MPO","ELANE","PRTN3","AZU1","RNASE3","CFD")),
                              name = "GMP"
                              )
pat.object <- AddModuleScore(pat.object,
                              features = list(c("CD38","KLF1","DEPTOR","ACSM3","APOC1","TFRC","ANK1","TMSB10","ALDH1A1","MT-ATP8","H2AFY","GYPB")),
                              name = "MEP"
                              )
pat.object <- AddModuleScore(pat.object,
                              features = list(c("BLVRB","HBB","APOC1","TFR2")),
                              name = "MEP_ERP"
                              )
pat.object <- AddModuleScore(pat.object,
                              features = list(c("MPIG6B","PF4","GP9","VWF","PPBP","SH3BP5","SELP","LTBP1","TMEM40")),
                              name = "MkP_Mk"
                              )

# FeaturePlots {.tabset}
sig_list <- c("HSPC1","CMP1","non_primed_CMP1","Mk_primed_CMP1","GMP1","MEP1","MEP_ERP1","MkP_Mk1")

for (i in 1:length(sig_list)){
    tryCatch({
      print(paste("###", sig_list[i], sep = " "))
      print(FeaturePlot(object = pat.object,
                        features = sig_list[i],
                        reduction = "umap",
                        cols = c("grey","lightblue","cyan3","cyan4","dodgerblue3","blue","mediumslateblue","purple","orchid3","red","brown","black"),
                        pt.size = 0.7)+
              NoAxes()+
              NoLegend()
            )
    }, error=function(e){cat("ERROR :",conditionMessage(e), "\n")})
}
```

## Panel F
```{r,fig.width=10,fig.height=10}
# Cell assignation based on signatures & both DotPlots
Idents(pat.object) <- "RNA_snn_res.0.8"
pat.object@meta.data$celltypes <- "NA"

for (i in 1:length(rownames(pat.object@meta.data))){
    if (pat.object@meta.data$RNA_snn_res.0.8[i] %in% 1){
      pat.object@meta.data$celltypes[i] <- "MkP_Mk"
      }
    if (pat.object@meta.data$RNA_snn_res.0.8[i] %in% c(0,8,6,2,5)){
      pat.object@meta.data$celltypes[i] <- "MEP"
      }
    if (pat.object@meta.data$RNA_snn_res.0.8[i] %in% 4){
      pat.object@meta.data$celltypes[i] <- "CMP"
      }
    if (pat.object@meta.data$RNA_snn_res.0.8[i] %in% 10){
      pat.object@meta.data$celltypes[i] <- "CMP_Primed"
      }
    if (pat.object@meta.data$RNA_snn_res.0.8[i] %in% 9){
      pat.object@meta.data$celltypes[i] <- "GMP"
      }
    if (pat.object@meta.data$RNA_snn_res.0.8[i] %in% c(3,7)){
      pat.object@meta.data$celltypes[i] <- "HSPC"
      }
}

# Plotting by celltypes
DimPlot(object = pat.object,
        pt.size = 0.7,
        reduction = "umap",
        group.by = "celltypes",
        order = T
        )
```

# Figure 4 {.tabset}
## Panel A
```{r,fig.height=20,fig.width=20}
# Assigning celltypes of independent objects to the combined one
for (i in 1:length(rownames(ETV6_2020@meta.data))){
    if (ETV6_2020@meta.data$ETV6status[i] %in% "Controls"){
        ETV6_2020@meta.data$barcode[i] <- paste("ctrl",rownames(ETV6_2020@meta.data)[i],sep = "_")
    }
    if (ETV6_2020@meta.data$ETV6status[i] %in% "Patients"){
        ETV6_2020@meta.data$barcode[i] <- paste("pat",rownames(ETV6_2020@meta.data)[i],sep = "_")
    }
}

tmp <- merge(x = ctrl.object,
            y = pat.object, 
            add.cell.ids = c("ctrl","pat")
            )

tmp_meta_data <- tmp@meta.data
tmp_meta_data$barcode <- rownames(tmp_meta_data)
tmp_meta_data <- tmp_meta_data[,-c(1:13,15:48,50:57)]

ETV6_tmp <- ETV6_2020@meta.data
ETV6_celltypes <- left_join(ETV6_tmp, tmp_meta_data)

ETV6_2020@meta.data$celltypes <- ETV6_celltypes$celltypes

# Plotting
DimPlot(object = ETV6_2020,
        pt.size = 0.7,
        reduction = "umap",
        group.by = "celltypes",
        order = T,
        split.by = "ETV6status"
        )

# removing tmp files 
rm(ETV6_tmp) 
rm(ETV6_celltypes)
rm(tmp)
```

## Panel B {.tabset}
### Dimplot Days 
```{r}
ETV6_2020@meta.data$orig.ident <- factor(ETV6_2020@meta.data$orig.ident,
                                           levels = c("D6", "D11")
                                           )

DimPlot(object = ETV6_2020,
        pt.size = 0.7,
        reduction = "umap",
        group.by = "orig.ident",
        order = T
        )
```

### Encart HSPCs
```{r}
df <- data.frame(ETV6_2020@meta.data,
                 UMAP_1 = ETV6_2020@reductions$umap@cell.embeddings[,1],
                 UMAP_2 = ETV6_2020@reductions$umap@cell.embeddings[,2]
                 )

df_HSPC <- df[df$celltypes == "HSPC",]
df_HSPC_ctrl <- df_HSPC[df_HSPC$ETV6status == "Controls",]
df_HSPC_pat <- df_HSPC[df_HSPC$ETV6status == "Patients",]


ggplot(df,
       aes(x=UMAP_1,y=UMAP_2),
       label = rownames(df))+
  geom_point(alpha=0.5,
             color="grey",
             size = 0.5)+
  geom_point(data = df_HSPC_ctrl,
             aes(x=UMAP_1,y=UMAP_2),
             color="salmon",
             size = 0.5)+
  geom_point(data = df_HSPC_pat,
             aes(x=UMAP_1,y=UMAP_2),
             color="cornflowerblue",
             size = 0.5)+
  theme_classic()
```

### Encart CMPs
```{r}
df_CMP <- df[df$celltypes == "CMP",]
df_CMP_ctrl <- df_CMP[df_CMP$ETV6status == "Controls",]
df_CMP_pat <- df_CMP[df_CMP$ETV6status == "Patients",]

ggplot(df,
       aes(x=UMAP_1,y=UMAP_2),
       label = rownames(df))+
  geom_point(alpha=0.5,
             color="grey",
             size = 0.5)+
  geom_point(data = df_CMP_ctrl,
             aes(x=UMAP_1,y=UMAP_2),
             color="salmon",
             size = 0.5)+
  geom_point(data = df_CMP_pat,
             aes(x=UMAP_1,y=UMAP_2),
             color="cornflowerblue",
             size = 0.5)+
  theme_classic()
```

### Encart CMP-Primed
```{r}
df_CMP_Primed <- df[df$celltypes == "CMP_Primed",]
df_CMP_Primed_ctrl <- df_CMP_Primed[df_CMP_Primed$ETV6status == "Controls",]
df_CMP_Primed_pat <- df_CMP_Primed[df_CMP_Primed$ETV6status == "Patients",]

ggplot(df,
       aes(x=UMAP_1,y=UMAP_2),
       label = rownames(df))+
  geom_point(alpha=0.5,
             color="grey",
             size = 0.5)+
  geom_point(data = df_CMP_Primed_ctrl,
             aes(x=UMAP_1,y=UMAP_2),
             color="salmon",
             size = 0.5)+
  geom_point(data = df_CMP_Primed_pat,
             aes(x=UMAP_1,y=UMAP_2),
             color="cornflowerblue",
             size = 0.5)+
  theme_classic()
```

### Encart GMP
```{r}
df_GMP <- df[df$celltypes == "GMP",]
df_GMP_ctrl <- df_GMP[df_GMP$ETV6status == "Controls",]
df_GMP_pat <- df_GMP[df_GMP$ETV6status == "Patients",]

ggplot(df,
       aes(x=UMAP_1,y=UMAP_2),
       label = rownames(df))+
  geom_point(alpha=0.5,
             color="grey",
             size = 0.5)+
  geom_point(data = df_GMP_ctrl,
             aes(x=UMAP_1,y=UMAP_2),
             color="salmon",
             size = 0.5)+
  geom_point(data = df_GMP_pat,
             aes(x=UMAP_1,y=UMAP_2),
             color="cornflowerblue",
             size = 0.5)+
  theme_classic()
```

### Encart MEP
```{r}
df_MEP <- df[df$celltypes == "MEP",]
df_MEP_ctrl <- df_MEP[df_MEP$ETV6status == "Controls",]
df_MEP_pat <- df_MEP[df_MEP$ETV6status == "Patients",]

ggplot(df,
       aes(x=UMAP_1,y=UMAP_2),
       label = rownames(df))+
  geom_point(alpha=0.5,
             color="grey",
             size = 0.5)+
  geom_point(data = df_MEP_ctrl,
             aes(x=UMAP_1,y=UMAP_2),
             color="salmon",
             size = 0.5)+
  geom_point(data = df_MEP_pat,
             aes(x=UMAP_1,y=UMAP_2),
             color="cornflowerblue",
             size = 0.5)+
  theme_classic()
```

### Encart MkP_Mk
```{r}
df_MkP_Mk <- df[df$celltypes == "MkP_Mk",]
df_MkP_Mk_ctrl <- df_MkP_Mk[df_MkP_Mk$ETV6status == "Controls",]
df_MkP_Mk_pat <- df_MkP_Mk[df_MkP_Mk$ETV6status == "Patients",]

ggplot(df,
       aes(x=UMAP_1,y=UMAP_2),
       label = rownames(df))+
  geom_point(alpha=0.5,
             color="grey",
             size = 0.5)+
  geom_point(data = df_MkP_Mk_ctrl,
             aes(x=UMAP_1,y=UMAP_2),
             color="salmon",
             size = 0.5)+
  geom_point(data = df_MkP_Mk_pat,
             aes(x=UMAP_1,y=UMAP_2),
             color="cornflowerblue",
             size = 0.5)+
  theme_classic()
```

## Radar plots {.tabset}
### Panel A
![radar_plot_0_to_100](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/Radarplot_Percent_0_100_Pool_Ctrl_Pat.png)

### Panel B
![radar_plot_MAX](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/Radarplot_Ctrl_Pat_Pool_Max_pecent.png)

# Figure 5 {.tabset}
## Panel  A
![traj_tem](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/trajectoires_et_plots/TRajectoire_Control_Lineage1.png)

## Panel  B
![traj_pat](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/trajectoires_et_plots/Trajectoire_Pat_Lineage1.png)

# Figure 6 {.tabset}
```{r, include=FALSE}
ETV6_2020@meta.data$celltypes_ETV6status <- paste(ETV6_2020@meta.data$ETV6status,
                                                  ETV6_2020@meta.data$celltypes,
                                                  sep = "_"
                                                  )
Idents(ETV6_2020) <- "celltypes_ETV6status"

list_tmp <- c(unique(ETV6_2020@meta.data$celltypes))

for (i in list_tmp[1:length(list_tmp)]){
  if(i != "Plt"){
    if(file.exists(paste(OUTPUT_PATH,paste("celltype", i,"markers_ETV6_2020_full.csv", sep = "_"),sep = ""))){
       assign(paste("celltype", i,".markers_volcano", sep = ""),read.csv(paste(OUTPUT_PATH,paste("celltype", i,"markers_ETV6_2020_full.csv", sep = "_"),sep = "")))}
    else{
      assign(paste("celltype", i,".markers_volcano", sep = ""), FindMarkers(ETV6_2020,features = all.genes, ident.1 = paste("Patients", i, sep = "_"), ident.2 = paste("Controls", i, sep = "_"),test.use = "bimod", only.pos = F, logfc.threshold = 0))
      print(paste("celltype", i,".markers_volcano", sep = ""))
      print(head(get(paste("celltype", i,".markers_volcano", sep = "")),n=50))
      write.table(get(paste("celltype", i,".markers_volcano", sep = "")),
                  paste("celltype", i,"markers_ETV6_2020_full.csv", sep = "_"),
                  quote=FALSE,row.names = TRUE, sep = ",")}
  }
}
```

## Panel A
* HSPC
```{r}
# HSPCs
celltypeHSPC.markers_volcano$Significant <- ifelse(celltypeHSPC.markers_volcano$p_val_adj < 0.05&celltypeHSPC.markers_volcano$avg_log2FC > 0.37 | celltypeHSPC.markers_volcano$p_val_adj < 0.05 & celltypeHSPC.markers_volcano$avg_log2FC < -0.37,
                                                   ifelse(celltypeHSPC.markers_volcano$avg_log2FC > 0,
                                                          "Upregulated bimod < 0.05",
                                                          "Downregulated bimod < 0.05"),
                                                   "Not Significative"
                                                   )

celltypeHSPC.markers_volcano$Significant2 <- ifelse(celltypeHSPC.markers_volcano$p_val_adj < 0.05&celltypeHSPC.markers_volcano$avg_log2FC > 1 | celltypeHSPC.markers_volcano$p_val_adj < 0.05 & celltypeHSPC.markers_volcano$avg_log2FC < -1,
                                                   ifelse(celltypeHSPC.markers_volcano$avg_log2FC > 0,
                                                          "Upregulated bimod < 0.05",
                                                          "Downregulated bimod < 0.05"),
                                                   "Not Significative"
                                                   )

celltypeHSPC.markers_volcano$genename <- rownames(celltypeHSPC.markers_volcano)

# number of genes upregulated (> 1.3 FC)
length(rownames(celltypeHSPC.markers_volcano[celltypeHSPC.markers_volcano$Significant == "Upregulated bimod < 0.05",]))
# number of genes downregulated (< -1.3 FC)
length(rownames(celltypeHSPC.markers_volcano[celltypeHSPC.markers_volcano$Significant == "Downregulated bimod < 0.05",]))
# number of genes upregulated (> 2 FC)
length(rownames(celltypeHSPC.markers_volcano[celltypeHSPC.markers_volcano$Significant2 == "Upregulated bimod < 0.05",]))
# number of genes downregulated (< -2 FC)
length(rownames(celltypeHSPC.markers_volcano[celltypeHSPC.markers_volcano$Significant2 == "Downregulated bimod < 0.05",]))


ggplot(celltypeHSPC.markers_volcano, aes(x = avg_log2FC, y = -log10(p_val_adj))) +
  geom_point(aes(color = Significant))+
  scale_color_manual(values = c("blue", "lightgrey","red")) +
  theme_bw(base_size = 12) + theme(legend.position = "bottom") +
  scale_x_continuous( limits=c(-2.5, 2.5)) +
  # scale_y_continuous( limits=c(-1, 35)) +
  geom_vline(xintercept = c(-0.37, 0.37),10) +
  # geom_vline(xintercept = c(-1, 1),10) +
  geom_hline(yintercept = 1.3) +
  ggtitle(label = ".°.") +
  geom_text_repel(
    data = subset(celltypeHSPC.markers_volcano, avg_log2FC > 0.37 & p_val_adj < 0.05 | p_val_adj < 0.05 & avg_log2FC < -0.37),
    aes(label = genename),
    size = 3.4,
    box.padding = unit(0.25, "lines"),
    point.padding = unit(0.25, "lines"))
```

## Panel B
* CMP
```{r}
# CMPs
celltypeCMP.markers_volcano$Significant <- ifelse(celltypeCMP.markers_volcano$p_val_adj < 0.05&celltypeCMP.markers_volcano$avg_log2FC > 0.37 | celltypeCMP.markers_volcano$p_val_adj < 0.05 & celltypeCMP.markers_volcano$avg_log2FC < -0.37,
                                                   ifelse(celltypeCMP.markers_volcano$avg_log2FC > 0,
                                                          "Upregulated bimod < 0.05",
                                                          "Downregulated bimod < 0.05"),
                                                   "Not Significative"
                                                   )

celltypeCMP.markers_volcano$Significant2 <- ifelse(celltypeCMP.markers_volcano$p_val_adj < 0.05&celltypeCMP.markers_volcano$avg_log2FC > 1 | celltypeCMP.markers_volcano$p_val_adj < 0.05 & celltypeCMP.markers_volcano$avg_log2FC < -1,
                                                   ifelse(celltypeCMP.markers_volcano$avg_log2FC > 0,
                                                          "Upregulated bimod < 0.05",
                                                          "Downregulated bimod < 0.05"),
                                                   "Not Significative"
                                                   )

celltypeCMP.markers_volcano$genename <- rownames(celltypeCMP.markers_volcano)

# number of genes upregulated (> 1.3 FC)
length(rownames(celltypeCMP.markers_volcano[celltypeCMP.markers_volcano$Significant == "Upregulated bimod < 0.05",]))
# number of genes downregulated (< -1.3 FC)
length(rownames(celltypeCMP.markers_volcano[celltypeCMP.markers_volcano$Significant == "Downregulated bimod < 0.05",]))
# number of genes upregulated (> 2 FC)
length(rownames(celltypeCMP.markers_volcano[celltypeCMP.markers_volcano$Significant2 == "Upregulated bimod < 0.05",]))
# number of genes downregulated (< -2 FC)
length(rownames(celltypeCMP.markers_volcano[celltypeCMP.markers_volcano$Significant2 == "Downregulated bimod < 0.05",]))

ggplot(celltypeCMP.markers_volcano, aes(x = avg_log2FC, y = -log10(p_val_adj))) +
  geom_point(aes(color = Significant))+
  scale_color_manual(values = c("blue", "lightgrey","red")) +
  theme_bw(base_size = 12) + theme(legend.position = "bottom") +
  scale_x_continuous( limits=c(-2.5, 2.5)) +
  # scale_y_continuous( limits=c(-1, 35)) +
  geom_vline(xintercept = c(-0.37, 0.37), "black", 10) +
  geom_hline(yintercept = 1.3) +
  ggtitle(label = ".°.") +
  geom_text_repel(
    data = subset(celltypeCMP.markers_volcano, avg_log2FC > 0.37 & p_val_adj < 0.05 | p_val_adj < 0.05 & avg_log2FC < -0.37),
    aes(label = genename),
    size = 3.4,
    box.padding = unit(0.25, "lines"),
    point.padding = unit(0.25, "lines"))
```

## Panel C
* CMP_Primed
```{r}
# CMP_Primed
celltypeCMP_Primed.markers_volcano$Significant <- ifelse(celltypeCMP_Primed.markers_volcano$p_val_adj < 0.05&celltypeCMP_Primed.markers_volcano$avg_log2FC > 0.37 | celltypeCMP_Primed.markers_volcano$p_val_adj < 0.05 & celltypeCMP_Primed.markers_volcano$avg_log2FC < -0.37,
                                                   ifelse(celltypeCMP_Primed.markers_volcano$avg_log2FC > 0,
                                                          "Upregulated bimod < 0.05",
                                                          "Downregulated bimod < 0.05"),
                                                   "Not Significative"
                                                   )

celltypeCMP_Primed.markers_volcano$Significant2 <- ifelse(celltypeCMP_Primed.markers_volcano$p_val_adj < 0.05&celltypeCMP_Primed.markers_volcano$avg_log2FC > 1 | celltypeCMP_Primed.markers_volcano$p_val_adj < 0.05 & celltypeCMP_Primed.markers_volcano$avg_log2FC < -1,
                                                   ifelse(celltypeCMP_Primed.markers_volcano$avg_log2FC > 0,
                                                          "Upregulated bimod < 0.05",
                                                          "Downregulated bimod < 0.05"),
                                                   "Not Significative"
                                                   )

celltypeCMP_Primed.markers_volcano$genename <- rownames(celltypeCMP_Primed.markers_volcano)

# number of genes upregulated (> 1.3 FC)
length(rownames(celltypeCMP_Primed.markers_volcano[celltypeCMP_Primed.markers_volcano$Significant == "Upregulated bimod < 0.05",]))
# number of genes downregulated (< -1.3 FC)
length(rownames(celltypeCMP_Primed.markers_volcano[celltypeCMP_Primed.markers_volcano$Significant == "Downregulated bimod < 0.05",]))
# number of genes upregulated (> 2 FC)
length(rownames(celltypeCMP_Primed.markers_volcano[celltypeCMP_Primed.markers_volcano$Significant2 == "Upregulated bimod < 0.05",]))
# number of genes downregulated (< -2 FC)
length(rownames(celltypeCMP_Primed.markers_volcano[celltypeCMP_Primed.markers_volcano$Significant2 == "Downregulated bimod < 0.05",]))

ggplot(celltypeCMP_Primed.markers_volcano, aes(x = avg_log2FC, y = -log10(p_val_adj))) +
  geom_point(aes(color = Significant))+
  scale_color_manual(values = c("blue", "lightgrey","red")) +
  theme_bw(base_size = 12) + theme(legend.position = "bottom") +
  scale_x_continuous( limits=c(-2.5, 2.5)) +
  # scale_y_continuous( limits=c(-1, 35)) +
  geom_vline(xintercept = c(-0.37, 0.37), "black", 10) +
  geom_hline(yintercept = 1.3) +
  ggtitle(label = ".°.") +
  geom_text_repel(
    data = subset(celltypeCMP_Primed.markers_volcano, avg_log2FC > 0.37 & p_val_adj < 0.05 | p_val_adj < 0.05 & avg_log2FC < -0.37),
    aes(label = genename),
    size = 3.4,
    box.padding = unit(0.25, "lines"),
    point.padding = unit(0.25, "lines"))
```

## Panel D
* GMP
```{r}
# GMPs
celltypeGMP.markers_volcano$Significant <- ifelse(celltypeGMP.markers_volcano$p_val_adj < 0.05&celltypeGMP.markers_volcano$avg_log2FC > 0.37 | celltypeGMP.markers_volcano$p_val_adj < 0.05 & celltypeGMP.markers_volcano$avg_log2FC < -0.37,
                                                   ifelse(celltypeGMP.markers_volcano$avg_log2FC > 0,
                                                          "Upregulated bimod < 0.05",
                                                          "Downregulated bimod < 0.05"),
                                                   "Not Significative"
                                                   )

celltypeGMP.markers_volcano$Significant2 <- ifelse(celltypeGMP.markers_volcano$p_val_adj < 0.05&celltypeGMP.markers_volcano$avg_log2FC > 1 | celltypeGMP.markers_volcano$p_val_adj < 0.05 & celltypeGMP.markers_volcano$avg_log2FC < -1,
                                                   ifelse(celltypeGMP.markers_volcano$avg_log2FC > 0,
                                                          "Upregulated bimod < 0.05",
                                                          "Downregulated bimod < 0.05"),
                                                   "Not Significative"
                                                   )

celltypeGMP.markers_volcano$genename <- rownames(celltypeGMP.markers_volcano)

# number of genes upregulated (> 1.3 FC)
length(rownames(celltypeGMP.markers_volcano[celltypeGMP.markers_volcano$Significant == "Upregulated bimod < 0.05",]))
# number of genes downregulated (< -1.3 FC)
length(rownames(celltypeGMP.markers_volcano[celltypeGMP.markers_volcano$Significant == "Downregulated bimod < 0.05",]))
# number of genes upregulated (> 2 FC)
length(rownames(celltypeGMP.markers_volcano[celltypeGMP.markers_volcano$Significant2 == "Upregulated bimod < 0.05",]))
# number of genes downregulated (< -2 FC)
length(rownames(celltypeGMP.markers_volcano[celltypeGMP.markers_volcano$Significant2 == "Downregulated bimod < 0.05",]))

ggplot(celltypeGMP.markers_volcano, aes(x = avg_log2FC, y = -log10(p_val_adj))) +
  geom_point(aes(color = Significant))+
  scale_color_manual(values = c("blue", "lightgrey","red")) +
  theme_bw(base_size = 12) + theme(legend.position = "bottom") +
  scale_x_continuous( limits=c(-3, 3)) +
  # scale_y_continuous( limits=c(-1, 35)) +
  geom_vline(xintercept = c(-0.37, 0.37), "black", 10) +
  geom_vline(xintercept = c(-1, 1), "black", 10) +
  geom_hline(yintercept = 1.3) +
  ggtitle(label = ".°.") +
  geom_text_repel(
    data = subset(celltypeGMP.markers_volcano, avg_log2FC > 0.37 & p_val_adj < 0.05 | p_val_adj < 0.05 & avg_log2FC < -0.37),
    aes(label = genename),
    size = 3.4,
    box.padding = unit(0.25, "lines"),
    point.padding = unit(0.25, "lines"))
```

## Panel E
* MEP
```{r}
# MEPs
celltypeMEP.markers_volcano$Significant <- ifelse(celltypeMEP.markers_volcano$p_val_adj < 0.05&celltypeMEP.markers_volcano$avg_log2FC > 0.37 | celltypeMEP.markers_volcano$p_val_adj < 0.05 & celltypeMEP.markers_volcano$avg_log2FC < -0.37,
                                                   ifelse(celltypeMEP.markers_volcano$avg_log2FC > 0,
                                                          "Upregulated bimod < 0.05",
                                                          "Downregulated bimod < 0.05"),
                                                   "Not Significative"
                                                   )

celltypeMEP.markers_volcano$Significant2 <- ifelse(celltypeMEP.markers_volcano$p_val_adj < 0.05&celltypeMEP.markers_volcano$avg_log2FC > 1 | celltypeMEP.markers_volcano$p_val_adj < 0.05 & celltypeMEP.markers_volcano$avg_log2FC < -1,
                                                   ifelse(celltypeMEP.markers_volcano$avg_log2FC > 0,
                                                          "Upregulated bimod < 0.05",
                                                          "Downregulated bimod < 0.05"),
                                                   "Not Significative"
                                                   )

celltypeMEP.markers_volcano$genename <- rownames(celltypeMEP.markers_volcano)

# number of genes upregulated (> 1.3 FC)
length(rownames(celltypeMEP.markers_volcano[celltypeMEP.markers_volcano$Significant == "Upregulated bimod < 0.05",]))
# number of genes downregulated (< -1.3 FC)
length(rownames(celltypeMEP.markers_volcano[celltypeMEP.markers_volcano$Significant == "Downregulated bimod < 0.05",]))
# number of genes upregulated (> 2 FC)
length(rownames(celltypeMEP.markers_volcano[celltypeMEP.markers_volcano$Significant2 == "Upregulated bimod < 0.05",]))
# number of genes downregulated (< -2 FC)
length(rownames(celltypeMEP.markers_volcano[celltypeMEP.markers_volcano$Significant2 == "Downregulated bimod < 0.05",]))

ggplot(celltypeMEP.markers_volcano, aes(x = avg_log2FC, y = -log10(p_val_adj))) +
  geom_point(aes(color = Significant))+
  scale_color_manual(values = c("blue", "lightgrey","red")) +
  theme_bw(base_size = 12) + theme(legend.position = "bottom") +
  #scale_x_continuous( limits=c(-2.5, 2.5)) +
  # scale_y_continuous( limits=c(-1, 35)) +
  geom_vline(xintercept = c(-0.37, 0.37), "black", 10) +
  geom_hline(yintercept = 1.3) +
  ggtitle(label = "") +
  geom_text_repel(
    data = subset(celltypeMEP.markers_volcano, avg_log2FC > 0.75 | -log10(p_val_adj) > 230 | avg_log2FC < -0.75),
    aes(label = genename),
    size = 3.4,
    box.padding = unit(0.25, "lines"),
    point.padding = unit(0.25, "lines"))
```

## Panel F
* MkP Mk
```{r}
# MkP_Mks
celltypeMkP_Mk.markers_volcano$Significant <- ifelse(celltypeMkP_Mk.markers_volcano$p_val_adj < 0.05&celltypeMkP_Mk.markers_volcano$avg_log2FC > 0.37 | celltypeMkP_Mk.markers_volcano$p_val_adj < 0.05 & celltypeMkP_Mk.markers_volcano$avg_log2FC < -0.37,
                                                   ifelse(celltypeMkP_Mk.markers_volcano$avg_log2FC > 0,
                                                          "Upregulated bimod < 0.05",
                                                          "Downregulated bimod < 0.05"),
                                                   "Not Significative"
                                                   )

celltypeMkP_Mk.markers_volcano$Significant2 <- ifelse(celltypeMkP_Mk.markers_volcano$p_val_adj < 0.05&celltypeMkP_Mk.markers_volcano$avg_log2FC > 1 | celltypeMkP_Mk.markers_volcano$p_val_adj < 0.05 & celltypeMkP_Mk.markers_volcano$avg_log2FC < -1,
                                                   ifelse(celltypeMkP_Mk.markers_volcano$avg_log2FC > 0,
                                                          "Upregulated bimod < 0.05",
                                                          "Downregulated bimod < 0.05"),
                                                   "Not Significative"
                                                   )

celltypeMkP_Mk.markers_volcano$genename <- rownames(celltypeMkP_Mk.markers_volcano)

# number of genes upregulated (> 1.3 FC)
length(rownames(celltypeMkP_Mk.markers_volcano[celltypeMkP_Mk.markers_volcano$Significant == "Upregulated bimod < 0.05",]))
# number of genes downregulated (< -1.3 FC)
length(rownames(celltypeMkP_Mk.markers_volcano[celltypeMkP_Mk.markers_volcano$Significant == "Downregulated bimod < 0.05",]))
# number of genes upregulated (> 2 FC)
length(rownames(celltypeMkP_Mk.markers_volcano[celltypeMkP_Mk.markers_volcano$Significant2 == "Upregulated bimod < 0.05",]))
# number of genes downregulated (< -2 FC)
length(rownames(celltypeMkP_Mk.markers_volcano[celltypeMkP_Mk.markers_volcano$Significant2 == "Downregulated bimod < 0.05",]))

ggplot(celltypeMkP_Mk.markers_volcano, aes(x = avg_log2FC, y = -log10(p_val_adj))) +
  geom_point(aes(color = Significant))+
  scale_color_manual(values = c("blue", "lightgrey","red")) +
  theme_bw(base_size = 12) + theme(legend.position = "bottom") +
  #scale_x_continuous( limits=c(-2.5, 2.5)) +
  # scale_y_continuous( limits=c(-1, 35)) +
  geom_vline(xintercept = c(-0.37, 0.37), "black", 10) +
  geom_hline(yintercept = 1.3) +
  ggtitle(label = "") +
  geom_text_repel(
    data = subset(celltypeMkP_Mk.markers_volcano, avg_log2FC > 1.3 | -log10(p_val_adj) > 275 | avg_log2FC < -1.3),
    aes(label = genename),
    size = 3.4,
    box.padding = unit(0.25, "lines"),
    point.padding = unit(0.25, "lines"))
```

```{r}
# extract both lists (Up/Down) for each celltype comparison
# for (i in list_tmp[1:length(list_tmp)]){
#   if(i != "Plt"){
#     assign(paste("celltype", i,".markers_volcano_1_3", sep = ""),rownames(get(paste("celltype", i,"markers_volcano")$Significant)))
#       print(paste("celltype", i,".markers_volcano_1_3", sep = ""))
#       print(head(get(paste("celltype", i,".markers_volcano_1_3", sep = "")),n=50))
#       write.table(get(paste("celltype", i,".markers_volcano_1_3", sep = "")),
#                   paste(OUTPUT_PATH,"celltype", i,".markers_volcano_1_3.txt", sep = "_"),
#                   quote=FALSE,row.names = TRUE, sep = "/n")
#       }
# }
```


# Figure 7 {.tabset}
## Down {.tabset}
### Barplots {.tabset}
#### GO
![Down_Barplot_GO](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/DOWN_barplot_GO_Biological_Process_2018.png)

#### KEGG
![Down_Barplot_KEGG](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/DOWN_barplot_KEGG_2019_Human.png)

#### REACTOME
![Down_Barplot_REACT](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/DOWN_barplot_Reactome_2016.png)

#### TRANSCRIPTION_FACTOR
![Down_Barplot_TF](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/DOWN_barplot_Transcription_Factor_PPIs.png)

#### TRANSFAC_JASPAR
![Down_Barplot_JASP](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/DOWN_barplot_TRANSFAC_and_JASPAR_PWMs.png)



### Bubbleplots {.tabset}
#### GO
![Down_Bubbleplot_GO](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/DOWN_bubbleplot_GO_Biological_Process_2018.png)

#### KEGG
![Down_Bubbleplot_KEGG](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/DOWN_bubbleplot_KEGG_2019_Human.png)

#### REACTOME
![Down_Bubbleplot_REACT](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/DOWN_bubbleplot_Reactome_2016.png)

#### TRANSCRIPTION_FACTOR
![Down_Bubbleplot_TF](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/DOWN_bubbleplot_Transcription_Factor_PPIs.png)

#### TRANSFAC_JASPAR
![Down_Bubbleplot_JASP](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/DOWN_bubbleplot_TRANSFAC_and_JASPAR_PWMs.png)




## Up {.tabset}
### Barplots {.tabset}
#### GO
![Up_Barplot_GO](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/UP_barplot_GO_Biological_Process_2018.png)

#### KEGG
![Up_Barplot_KEGG](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/UP_barplot_KEGG_2019_Human.png)

#### REACTOME
![Up_Barplot_REACT](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/UP_barplot_Reactome_2016.png)

#### TRANSCRIPTION_FACTOR
![Up_Barplot_TF](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/UP_barplot_Transcription_Factor_PPIs.png)

#### TRANSFAC_JASPAR
![Up_Barplot_JASP](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/UP_barplot_TRANSFAC_and_JASPAR_PWMs.png)


### Bubbleplots {.tabset}
#### GO
![Up_Bubbleplot_GO](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/UP_bubbleplot_GO_Biological_Process_2018.png)

#### KEGG
![Up_Bubbleplot_KEGG](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/UP_bubbleplot_KEGG_2019_Human.png)

#### REACTOME
![Up_Bubbleplot_REACT](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/UP_bubbleplot_Reactome_2016.png)

#### TRANSCRIPTION_FACTOR
![Up_Bubbleplot_TF](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/UP_bubbleplot_Transcription_Factor_PPIs.png)

#### TRANSFAC_JASPAR
![Up_Bubbleplot_JASP](/home/bigott/workspace/Papers/ETV6/99_figures_papier/01_figure_1/enrichR/INPUT_DEGs/enrichR/plots/UP_bubbleplot_TRANSFAC_and_JASPAR_PWMs.png)

# Figure 8
* Under construction 